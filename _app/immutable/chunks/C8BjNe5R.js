import{h as v,T as Y,b6 as S,g as a,i,b7 as E,p as M,b as T,e as l,s as u,r as c,t as L,a as j,d as U,aI as O,c as V,f as F}from"./eXUqL77E.js";import"./DsnmJJEf.js";import{s as G,e as K,d as N}from"./BemXrffE.js";import{s as q}from"./Bc3ktxwc.js";import{i as $}from"./CTMdkGpN.js";import{s as C,a as H}from"./y59AJ40k.js";import{e as J,p as _,f as Q,h as R}from"./B0neLVfT.js";import{r as W}from"./CujdopWx.js";import{b as X}from"./CEUJmi10.js";import{M as D}from"./71ylWyng.js";var Z=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ee=["difference","intersection","symmetricDifference","union"],I=!1;class B extends Set{#r=new Map;#e=v(0);#s=v(0);#t=S||-1;constructor(e){if(super(),e){for(var s of e)super.add(s);this.#s.v=super.size}I||this.#o()}#a(e){return S===this.#t?v(e):Y(e)}#o(){I=!0;var e=B.prototype,s=Set.prototype;for(const r of Z)e[r]=function(...t){return a(this.#e),s[r].apply(this,t)};for(const r of ee)e[r]=function(...t){a(this.#e);var f=s[r].apply(this,t);return new B(f)}}has(e){var s=super.has(e),r=this.#r,t=r.get(e);if(t===void 0){if(!s)return a(this.#e),!1;t=this.#a(!0),r.set(e,t)}return a(t),s}add(e){return super.has(e)||(super.add(e),i(this.#s,super.size),E(this.#e)),this}delete(e){var s=super.delete(e),r=this.#r,t=r.get(e);return t!==void 0&&(r.delete(e),i(t,!1)),s&&(i(this.#s,super.size),E(this.#e)),s}clear(){if(super.size!==0){super.clear();var e=this.#r;for(var s of e.values())i(s,!1);e.clear(),i(this.#s,0),E(this.#e)}}keys(){return this.values()}values(){return a(this.#e),super.values()}entries(){return a(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#s)}}var se=T('<div class="password-prompt-container svelte-1iwlj7a"><div class="password-prompt-card svelte-1iwlj7a"><h2 class="svelte-1iwlj7a">Enter Your Encryption Password</h2> <!> <form><div class="input-group svelte-1iwlj7a"><label for="password" class="svelte-1iwlj7a">Password:</label> <input id="password" type="password" placeholder="Enter your encryption password" class="svelte-1iwlj7a"/></div> <!> <button type="submit" class="svelte-1iwlj7a"> </button></form></div></div>');function re(k,e){M(e,!0);let s=v(""),r=v(""),t=v(!1);const f=async()=>{i(r,""),i(t,!0);try{const o=await J();if(o.length===0){_.setPassword(a(s));return}const w=o[0];try{const{keyB64:z}=Q({password:a(s),saltB64:w.saltB64});R({ciphertextB64:w.ciphertextB64,nonceB64:w.nonceB64,keyB64:z}),_.setPassword(a(s))}catch{i(r,"Invalid password. Unable to decrypt existing events.")}}catch(o){i(r,`Error validating password: ${o.message}`)}finally{i(t,!1)}},y=o=>{o.preventDefault(),f()};var h=se(),b=l(h),g=u(l(b),2);D(g,{item:{level:"info",header:"Important Security Notice",message:"Your data is encrypted with your password. If you forget your password, your data cannot be recovered. Please store your password securely."}});var n=u(g,2),d=l(n),p=u(l(d),2);W(p),c(d);var m=u(d,2);{var P=o=>{{let w=O(()=>({level:"error",header:"Error",message:a(r)}));D(o,{get item(){return a(w)}})}};$(m,o=>{a(r)&&o(P)})}var x=u(m,2),A=l(x,!0);c(x),c(n),c(b),c(h),L(()=>{p.disabled=a(t),x.disabled=!a(s)||a(t),G(A,a(t)?"Validating...":"Unlock")}),K("submit",n,y),X(p,()=>a(s),o=>i(s,o)),j(k,h),U()}var te=T('<div class="unlocked-container svelte-6xvh5b"><!> <div class="lock-button-container svelte-6xvh5b"><button>ðŸ”’ Lock</button></div></div>');function fe(k,e){M(e,!0);const s=()=>H(_,"$personalTrackerPassword",r),[r,t]=C(),f=()=>{confirm("Are you sure you want to lock? You will need to re-enter your password.")&&_.clearPassword()};var y=V(),h=F(y);{var b=n=>{var d=te(),p=l(d);q(p,()=>e.children);var m=u(p,2),P=l(m);P.__click=f,c(m),c(d),j(n,d)},g=n=>{re(n,{})};$(h,n=>{s()?n(b):n(g,!1)})}j(k,y),U(),t()}N(["click"]);export{fe as P,B as S};
