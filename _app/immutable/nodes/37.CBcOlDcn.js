import"../chunks/DsnmJJEf.js";import"../chunks/ctDXYmCv.js";import{p as W,h as s,F as D,d as L,g as e,b as T,s as a,f as x,i as r,e as E,r as G,a as A}from"../chunks/eXUqL77E.js";import{i as j}from"../chunks/UpJSkP_W.js";import{g as q}from"../chunks/BJmgLU8A.js";import"../chunks/CguJ9Ee1.js";import{p as z}from"../chunks/B4-ntoLf.js";/* empty css                */import"../chunks/B0neLVfT.js";import{i as J}from"../chunks/CTMdkGpN.js";import{r as f,c as K}from"../chunks/CujdopWx.js";import{b as v}from"../chunks/CEUJmi10.js";import{F as O,a as Q,c as V,h as X}from"../chunks/Btnq2GL3.js";import{M as Y}from"../chunks/QYQDLQnr.js";import{c as I}from"../chunks/DfQIOrcr.js";var Z=T('<label for="css-selector">CSS selector</label> <input type="textarea"/>',1),ee=T('<label for="name">Name</label> <input type="text"/> <label for="check-interval">Check interval</label> <!> <label for="notification-message">Notification message (the @mention is automatically added)</label> <input type="textarea"/> <label for="watch-type">Watcher type</label> <select id="watch-type"><option>CSS</option><option>HASH</option></select> <label for="content">URL</label> <input type="textarea"/> <!> <!>',1);function te(S,u){W(u,!0);let o=s(D([])),i=s(""),n=s(""),c=s(""),m=s(""),p=s(0),l=s("CSS"),b=s(!1);const $=async()=>{r(o,[],!0),e(i)?.length||e(o).push({level:"error",header:"name must be defined"}),e(n)||e(o).push({level:"error",header:"notification message must be defined"}),e(l)==="CSS"&&!e(m)&&e(o).push({level:"error",header:"A CSS watcher must have a css selector defined"}),e(p)<900&&e(o).push({level:"error",header:"Check interval too small. Must be >= 15mn"});try{new URL(e(c))}catch{e(o).push({level:"error",header:"The URL is invalid"})}if(!e(o).length)try{r(b,!0),e(l)==="CSS"?await I({name:e(i),notificationMessage:e(n),url:e(c),cssSelector:e(m),checkIntervalSeconds:e(p),watchType:e(l)}):e(l)==="HASH"&&await I({name:e(i),notificationMessage:e(n),url:e(c),checkIntervalSeconds:e(p),watchType:e(l)}),u.onUpload()}catch(h){X(h)}finally{r(b,!1)}};O(S,{title:"Add a new watcher",backUrl:"/webwatcher",get noticeMessages(){return e(o)},children:(h,ae)=>{Q(h,{children:(R,re)=>{var C=ee(),g=a(x(C),2);f(g);var k=a(g,4);Y(k,{allowedUnits:["minutes","hours","days"],defaultDuration:{value:1,unit:"hours"},get valueInSeconds(){return e(p)},set valueInSeconds(t){r(p,t,!0)}});var _=a(k,4);f(_);var d=a(_,4),y=E(d);y.value=y.__value="CSS";var M=a(y);M.value=M.__value="HASH",G(d);var w=a(d,4);f(w);var F=a(w,2);{var N=t=>{var H=Z(),U=a(x(H),2);f(U),v(U,()=>e(m),B=>r(m,B)),A(t,H)};J(F,t=>{e(l)==="CSS"&&t(N)})}var P=a(F,2);V(P,{onclick:$,get loading(){return e(b)}}),v(g,()=>e(i),t=>r(i,t)),v(_,()=>e(n),t=>r(n,t)),K(d,()=>e(l),t=>r(l,t)),v(w,()=>e(c),t=>r(c,t)),A(R,C)}})},$$slots:{default:!0}}),L()}function ge(S,u){W(u,!1),z.set({name:"Web Watchers",showAuthInHeader:!0}),j(),te(S,{onUpload:()=>q("/webwatcher")}),L()}export{ge as component};
