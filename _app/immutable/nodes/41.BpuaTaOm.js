import"../chunks/DsnmJJEf.js";import{a as me}from"../chunks/vjUZdrab.js";import{p as Se,h as Q,F as ve,b as f,f as de,i as E,s as a,g as e,t as U,a as b,d as _e,e as o,r as c}from"../chunks/eXUqL77E.js";import{d as ue,s as he}from"../chunks/BemXrffE.js";import{i as be}from"../chunks/CTMdkGpN.js";import{e as I,i as B}from"../chunks/D9zXBg3D.js";import{r as g,b as ce}from"../chunks/CujdopWx.js";import{b as m}from"../chunks/CEUJmi10.js";import{P as fe}from"../chunks/Bsmh5y_W.js";import{V as pe}from"../chunks/DZlSUHst.js";const xe=function(x,u,z,d,p){return(x-u)/(z-u)*(p-d)+d},C=(x,u)=>Math.random()*(u-x)+x,w=[[119,114,37,250],[84,119,37,220],[112,181,21,190],[120,211,2,160],[173,211,2,130],[98,54,130,100],[153,83,198,70],[148,39,226,40],[226,39,113,10]],Fe=()=>{const x=[];x.push({upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:Number(C(.2,1).toFixed(4)),cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:15,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(C(2,4)),color:w[0]});for(let u=0;u<C(5,8);u++)x.push({upwardForce:0,allowOffspringBirthFactor:Number((1-u*.1).toFixed(4)),cellDeviationFactor:Number(C(.2,1).toFixed(4)),cellSizeVariationInSegment:Number(C(.93,.99).toFixed(4)),cellSpacingVariationInSegment:Number(C(.4,.6).toFixed(4)),nbCellsInSegment:Math.floor(C(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(C(40,180)),nbBranches:Math.floor(C(2,4)),color:w[u+1]});return x[1].nbCellsInSegment=10,x},Ie=[{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:w[0]},{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[1]},{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[2]},{upwardForce:0,allowOffspringBirthFactor:.9,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[3]},{upwardForce:0,allowOffspringBirthFactor:.8,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:w[4]},{upwardForce:0,allowOffspringBirthFactor:.8,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[5]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:w[6]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[7]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.6,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[8]}];class Be{genes;structure;constructor(){this.genes=Ie,this.structure=[]}grow(){this.structure=[];const u=[{cell:{position:new pe,size:20,color:[200,200,200,200]},agent:{level:0,levelStep:0,direction:new pe(0,20)}}];for(;u.length;){const{cell:z,agent:d}=u.shift();if(d.level===this.genes.length)continue;const{allowOffspringBirthFactor:p,cellDeviationFactor:M,cellSpacingVariationInSegment:G,nbCellsInSegment:y,color:W,cellSizeVariationInSegment:s,nextSegmentBaseCellSize:X,branchesMaxAngle:L,nbBranches:R}=this.genes[d.level];if(d.levelStep>=y){const Y=-L/2,H=L/2;for(let T=0;T<R;T++){const K=xe(T,0,R-1,Y,H),Z={position:z.position.clone(),size:z.size*X,color:[200,200,200,200]},ee={level:d.level+1,levelStep:0,direction:d.direction.clone().rotateByDeg(K)};Math.random()<p&&u.push({cell:Z,agent:ee})}continue}const A={...z,position:z.position.clone().add(d.direction.clone().rotateByDeg(C(-45,45)*M).multiplyScalar(G)),size:z.size*s,color:W},J={level:d.level,levelStep:d.levelStep+1,direction:d.direction.clone()};u.push({cell:A,agent:J}),this.structure.push(A)}}}var we=f('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),ze=f('<div class="genes-container svelte-k14fpo"><div>Level</div> <div>upwardForce</div> <div>allowOffspringBirthFactor</div> <div>cellDeviationFactor</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),Ce=f("<div></div>"),Ve=f('<div><input type="number" step="0.1"/></div>'),ye=f('<div><input type="number" step="0.1"/></div>'),Me=f('<div><input type="number" step="0.1"/></div>'),Ae=f('<div><input type="number" step="0.1"/></div>'),De=f('<div><input type="number" step="1"/></div>'),$e=f('<div><input type="number" step="0.1"/></div>'),Oe=f('<div><input type="number" step="0.1"/></div>'),ke=f('<div><input type="number" step="1"/></div>'),Pe=f('<div><input type="number" step="1"/></div>'),Ne=f('<div class="genes-container-2 svelte-k14fpo"><div>Level</div> <!> <div>upwardForce</div> <!> <div>allowOffspringBirthFactor</div> <!> <div>cellDeviationFactor</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),Ge=f("<!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function Ue(x,u){Se(u,!0);let z;const d=new Be;let p=Q(ve([...d.genes]));d.grow();let M=Q(ve(d.structure.length)),G=Q(!0),y=Q(0);const W=()=>{E(p,Fe(),!0),s()},s=()=>{d.genes=e(p),d.grow(),E(M,d.structure.length,!0),E(y,0)},X=S=>{S.setup=()=>{z=S,S.createCanvas(1e3,600),S.noStroke()},S.draw=()=>{S.background(240,240,240);for(let F=0;F<e(y);F++){const V=d.structure[F],D=V.position.x+S.width/2,r=S.height-V.position.y,$=V.size;S.fill(V.color),S.circle(D,r,$)}e(y)<e(M)&&E(y,Math.min(e(y)+50,e(M)),!0)}};me(()=>{console.clear(),z?.remove()});var L=Ge(),R=de(L);fe(R,{sketch:X});var A=a(R,2),J=a(o(A),2),Y=o(J);c(J),c(A);var H=a(A,2),T=a(o(H),2);T.__click=()=>E(G,!e(G)),c(H);var K=a(H,2);K.__click=W;var Z=a(K,2);{var ee=S=>{var F=ze(),V=a(o(F),20);I(V,17,()=>e(p),B,(D,r,$)=>{var j=we(),O=de(j);O.textContent=$;var k=a(O,2),P=o(k);g(P),P.__change=s,c(k);var N=a(k,2),q=o(N);g(q),q.__change=s,c(N);var l=a(N,2),i=o(l);g(i),i.__change=s,c(l);var h=a(l,2),n=o(h);g(n),n.__change=s,c(h);var t=a(h,2),v=o(t);g(v),v.__change=s,c(t);var ne=a(t,2),te=o(ne);g(te),te.__change=s,c(ne);var ie=a(ne,2),ae=o(ie);g(ae),ae.__change=s,c(ie);var re=a(ie,2),le=o(re);g(le),le.__change=s,c(re);var se=a(re,2),oe=o(se);g(oe),oe.__change=s,c(se),U(()=>ce(O,`color: ${e(r).color??""}`)),m(P,()=>e(r).upwardForce,_=>e(r).upwardForce=_),m(q,()=>e(r).allowOffspringBirthFactor,_=>e(r).allowOffspringBirthFactor=_),m(i,()=>e(r).cellDeviationFactor,_=>e(r).cellDeviationFactor=_),m(n,()=>e(r).cellSizeVariationInSegment,_=>e(r).cellSizeVariationInSegment=_),m(v,()=>e(r).nbCellsInSegment,_=>e(r).nbCellsInSegment=_),m(te,()=>e(r).cellSpacingVariationInSegment,_=>e(r).cellSpacingVariationInSegment=_),m(ae,()=>e(r).nextSegmentBaseCellSize,_=>e(r).nextSegmentBaseCellSize=_),m(le,()=>e(r).branchesMaxAngle,_=>e(r).branchesMaxAngle=_),m(oe,()=>e(r).nbBranches,_=>e(r).nbBranches=_),b(D,j)}),c(F),b(S,F)},ge=S=>{var F=Ne(),V=a(o(F),2);I(V,17,()=>e(p),B,(l,i,h)=>{var n=Ce();n.textContent=h,U(()=>ce(n,`color: ${e(i).color??""}`)),b(l,n)});var D=a(V,4);I(D,17,()=>e(p),B,(l,i,h)=>{var n=Ve(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).upwardForce,v=>e(i).upwardForce=v),b(l,n)});var r=a(D,4);I(r,17,()=>e(p),B,(l,i,h)=>{var n=ye(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).allowOffspringBirthFactor,v=>e(i).allowOffspringBirthFactor=v),b(l,n)});var $=a(r,4);I($,17,()=>e(p),B,(l,i,h)=>{var n=Me(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).cellDeviationFactor,v=>e(i).cellDeviationFactor=v),b(l,n)});var j=a($,4);I(j,17,()=>e(p),B,(l,i,h)=>{var n=Ae(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).cellSizeVariationInSegment,v=>e(i).cellSizeVariationInSegment=v),b(l,n)});var O=a(j,4);I(O,17,()=>e(p),B,(l,i,h)=>{var n=De(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).nbCellsInSegment,v=>e(i).nbCellsInSegment=v),b(l,n)});var k=a(O,4);I(k,17,()=>e(p),B,(l,i,h)=>{var n=$e(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).cellSpacingVariationInSegment,v=>e(i).cellSpacingVariationInSegment=v),b(l,n)});var P=a(k,4);I(P,17,()=>e(p),B,(l,i,h)=>{var n=Oe(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).nextSegmentBaseCellSize,v=>e(i).nextSegmentBaseCellSize=v),b(l,n)});var N=a(P,4);I(N,17,()=>e(p),B,(l,i,h)=>{var n=ke(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).branchesMaxAngle,v=>e(i).branchesMaxAngle=v),b(l,n)});var q=a(N,4);I(q,17,()=>e(p),B,(l,i,h)=>{var n=Pe(),t=o(n);g(t),t.__change=s,c(n),m(t,()=>e(i).nbBranches,v=>e(i).nbBranches=v),b(l,n)}),c(F),U(()=>ce(F,`--nb-columns: ${1+e(p).length}`)),b(S,F)};be(Z,S=>{e(G)?S(ee):S(ge,!1)})}U(()=>he(Y,`Nb segments: ${e(M)??""}`)),b(x,L),_e()}ue(["click","change"]);export{Ue as component};
